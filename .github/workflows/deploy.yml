name: Deploy

on: [push]

jobs:
    build:
        runs-on: ubuntu-latest
        env:
            APP_VERSION_SECRET: ${{secrets.APP_VERSION}}

        steps:
            - name: Checkout
              uses: actions/checkout@v2

            - name: Copy .env
              run: cp .env.example .env

            - name: Paste secrets value to .env
              run: |
                  dotenv=$(cat .env)
                  test=400
                  newenv=${dotenv/APP_VERSION=/APP_VERSION="$test"}
                  echo $APP_VERSION_SECRET
                  echo $newenv >> .env

            - name: Generate public html
              run: sh app_version.sh

            - name: Debug
              run: cat index.html
